extends ./template/layout.jade


block custom_header
	style.
		#mainWrap{
			margin: 0 auto;
		}
		#innerWrap{
			text-align:left;
			position:relative;
		}
		
		#leftWrap{
			width:39%;
			margin:0;
			padding: 0;
			position: relative;
			left:0;
			min-height:450px;
			overflow-y:auto;
			max-height:700px;
		}
		#rightWrap{
			width:59%;
			position:absolute;
			right:0;
			top:0;
		}
		
		
	
		.transEntry{
			width:100%;
		}
		.transDate, .transBlock{
			padding:4px;
			display:inline-block;
		}
		.transDate{
			border:1px #fff solid;
		}
		.transBlock{
			width:350px;
			background:#5B9BD5;
			color:#fff;
			border:1px #41719C solid;
			border-top:1px #5B9BD5 solid;
			text-align:center;
			cursor: pointer;
		}
		.transBlock:hover{
			border-color:#fff;
		}
		
		#stateWrap{
			margin:15px;
			min-height: 400px;
			padding:10px;
		}
		
		.borderMe{
			border: 1px #41719C solid;
		}
		
		.selected{
			font-weight:900;
			background: #555;
			border-top:1px #555 solid;
		}
		
		#funWrap{
			padding:10px;
		}
		
		.remove, .refresh{
			margin:0px 5px;
			cursor:pointer;
		}
		
		.fa{
			color: #2e6da4;
		}
		
		
		
	script(type='text/javascript').
		$(document).ready(function(){

			function in_array(name, array){
				for(var i in array){
					if(array[i] == name) return true
				}
				return false;	
			}
			buildThings(bag.cc);
			function buildThings(cc){
				var skip = ['write', 'read', 'delete', 'init'];
				var html = '';
				var field = '<input class="arginput" type="text" placeholder="array of strings"/>';
				for(var i in cc.details.func){
					if(!in_array(cc.details.func[i].toLowerCase(), skip)){
						html += '<div class="func">' + cc.details.func[i] + '([ ' + field + ']); </dic>'
						html += '<button type="button" class="go" func="' + cc.details.func[i] + '"> Run </button>';
					}
				}
				$("#ccWrap").append(html);
			}
			
			$(document).on("click", ".go", function(){
				var host = $("input[name='host']").val();
				var port = $("input[name='port']").val();
				var args = $(this).prev().val();
				console.log(host, args);
				
				var data = {
								"chaincodeSpec": {
									"type": "GOLANG",
									"chaincodeID": bag.cc.details.name,
									"ctorMsg": {
										"function": "invoke",
										"args": [args]
									}
								}
							};
				
				$.ajax({
					method: 'GET',
					url: 'http://' + host + ':' + port + '/devops/invoke',
					data: JSON.stringify(data),
					contentType: 'application/json',
					success: function(json){
						console.log('Success', json);
					},
					error: function(e){
						console.log('Error', e);
					}
				});
				
			});
			
			$("input[name='host']").val(bag.cc.details.host);
			$("input[name='port']").val(bag.cc.details.port);
			
			
			//////////////////////////////// jQuery Nav ////////////////////////////
			$(document).on("click", ".transBlock", function(){
				var html = "";
				html += $(this).prev().html();
				html += " " + $(this).html();
				$("#selectedLegend").html(html);
			})
		});

block content
	h1 ChainCode Investigator
	p Examine/test your chaincode
	
	hr
	
	
	#mainWrap
		input(type="text" name="host" placeholder="Peer IP" style="margin-left:0;")
		input(type="text" name="port" placeholder= "Peer Port")
		
		#innerWrap.borderMe
			#leftWrap
				.transEntry
					.transDate 10:48am
					.transBlock deploy()
				.transEntry
					.transDate 10:48am
					.transBlock deploy()
				.transEntry
					.transDate 10:48am
					.transBlock deploy()
				.transEntry
					.transDate 10:48am
					.transBlock deploy()
				.transEntry
					.transDate 10:48am
					.transBlock deploy()
				.transEntry
					.transDate 10:48am
					.transBlock deploy()
				.transEntry
					.transDate 10:48am
					.transBlock deploy()
				.transEntry
					.transDate 10:48am
					.transBlock deploy()
				.transEntry
					.transDate 10:48am
					.transBlock deploy()
				.transEntry
					.transDate 10:48am
					.transBlock deploy()
				.transEntry
					.transDate 10:48am
					.transBlock deploy()
				.transEntry
					.transDate 10:48am
					.transBlock deploy()
				.transEntry
					.transDate 10:48am
					.transBlock deploy()
				.transEntry
					.transDate 10:48am
					.transBlock deploy()
				.transEntry
					.transDate 10:48am
					.transBlock deploy()
				.transEntry
					.transDate 10:48am
					.transBlock deploy()
				.transEntry
					.transDate 10:48am
					.transBlock deploy()
				.transEntry
					.transDate 10:48am
					.transBlock deploy()
				.transEntry
					.transDate 10:48am
					.transBlock deploy()
				.transEntry
					.transDate 10:48am
					.transBlock deploy()
				.transEntry
					.transDate 10:49am
					.transBlock deploy()
				.transEntry
					.transDate 10:50am
					.transBlock deploy()
				.transEntry
					.transDate 10:55am
					.transBlock deploy()
				.transEntry
					.transDate 10:58am
					.transBlock deploy()
				.transEntry#current
					.transDate 10:50am
					.transBlock.selected Current
					
			#rightWrap
				#stateWrap.borderMe
					center
						h2#selectedLegend 10:48: Current
					.var
						span A = 
						input(type="text" placeholder="???" name="var_A")
						.fa.fa-refresh.refresh
						.fa.fa-remove.remove
					.var
						span B = 
						input(type="text" placeholder="???" name="var_B")
						.fa.fa-refresh.refresh
						.fa.fa-remove.remove
					.var
						span C = 
						input(type="text" placeholder="???" name="var_C")
						.fa.fa-refresh.refresh
						.fa.fa-remove.remove
	
	br
	
	#funWrap.borderMe
		
		form#ccWrap
			h2 CRUD:
			hr
			.func 
				span Read (
				input(type="text" name="read_name" placeholder="var name")
				span ); 
				button(type="button")#query Run
			
			.func 
				span Write (
				input(type="text" name="write_name" placeholder="var name")
				input(type="text" name="write_val" placeholder="value")
				span ); 
				button(type="button")#query Run
				
			.func 
				span Remove (
				input(type="text" name="remove_name" placeholder="var name")
				span ); 
				button(type="button")#query Run
			
			.func 
				span Init (
				input(type="text" name="init_names" placeholder="array of strings")
				span ); 
				button(type="button")#query Run
			br
			h2 Custom:
			hr
		
